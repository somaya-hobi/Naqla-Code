<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Tickets Admin</title>
</head>

<body>
  <main>
    <h1>Add Tickets</h1>
    <div class="container" id="ticketCardsContainer"></div>
    <article class="add-house-form">
      <h2>Enter the information</h2>
      <form id="bookTicketForm">
        <div class="form-group">
          <label for="houseId">House ID:</label><br>
          <input type="text" id="houseId" name="houseId" required>
        </div>
        <div class="form-group">
          <label for="time">Time:</label><br>
          <input type="text" id="time" name="time" required>
        </div>
        <div class="form-group">
          <label for="day">Day:</label><br>
          <input type="text" id="day" name="day" required>
        </div>
        <div class="form-group">
          <label for="month">Month:</label><br>
          <input type="text" id="month" name="month" required>
        </div>
        <div class="form-group">
          <label for="count">Number of Tickets:</label><br>
          <input type="text" id="count" name="count" required>
        </div>
        <button type="submit" id="addTicket" name="bookTicket_submit">Add Ticket</button>
      </form>
    </article>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
  <script src="../JS/Ticket.js"></script>
  <!--<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, push, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAb-YVnmlKhe4NUAhGInLIPnBPepEjpLu8",
      authDomain: "naqla-vr.firebaseapp.com",
      databaseURL: "https://naqla-vr-default-rtdb.firebaseio.com",
      projectId: "naqla-vr",
      storageBucket: "naqla-vr.appspot.com",
      messagingSenderId: "532930291336",
      appId: "1:532930291336:web:a8fed45ec0fdeed728613d",
      measurementId: "G-HH44E4L1W6"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    addTicket.addEventListener('click', (e) => {
      e.preventDefault();

      const houseId = document.getElementById('houseId').value;
      const time = document.getElementById('time').value;
      const day = document.getElementById('day').value;
      const month = document.getElementById('month').value;
      const countTicket = document.getElementById('count').value;


      // Check if house ID exists before creating a ticket
      get(ref(database, '/Houses/' + houseId + '/'))
        .then((snapshot) => {

          if (snapshot.exists()) {
            const newTicketRef = push(ref(database, 'Tickets'));
            set(newTicketRef, {
              houseId: houseId, // Store house ID as foreign key
              ticketTime: time,
              ticketDay: day,
              ticketMonth: month,
              ticketCount: countTicket
            }).then(() => {
              alert('Ticket added successfully!');
            }).catch((error) => {
              console.error('Error adding ticket: ', error);
              alert('Error adding ticket: ' + error.message);
            });
          } else {
            alert('Invalid House ID. Please enter a valid ID.');
          }
        })
        .catch((error) => {
          console.error('Error checking house ID: ', error);
          alert('An error occurred');
        });
    });

  </script>-->
  
</body>

</html>